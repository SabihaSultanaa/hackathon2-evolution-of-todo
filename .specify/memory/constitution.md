<!--
Sync Impact Report:
- Version change: 1.0.0 → 1.1.0
- Modified principles: None (all Phase I & II principles preserved)
- Added sections: Phase III: AI-Agentic Standards (4 new principles)
- Templates requiring updates: ✅ no changes needed (templates remain aligned with constitution structure)
- Follow-up TODOs: None
-->

# Todo CLI Constitution

## Core Principles

### I. Spec-Driven Development (SDD)
Every feature MUST be defined in a Markdown specification before implementation begins.
All code MUST be generated by the AI from these specs. Every user prompt MUST be
recorded verbatim in a Prompt History Record (PHR) under `history/prompts/`. The AI
acts as Developer; the User acts as Architect.

**Rationale**: Ensures traceability, prevents ad-hoc decisions, and maintains a clear
audit trail of all development work.

### II. Separation of Concerns
The codebase MUST maintain clear architectural boundaries between CLI (UI/Presentation)
and Service (Business Logic). These layers MUST NOT be coupled - changes to user
interface MUST NOT require changes to business logic, and vice versa.

**Rationale**: Promotes maintainability, testability, and enables independent evolution
of UI and business logic layers.

### III. Atomic Implementation
Features MUST be implemented one at a time. Each feature MUST be independently
testable and complete before beginning the next. No combining multiple features
in a single implementation cycle.

**Rationale**: Reduces complexity, simplifies debugging, and enables incremental
delivery of value.

### IV. In-Memory Storage (Phase I)
Persistence MUST use in-memory data structures only for Phase I. No databases,
file-based storage, or external state management until explicitly specified in
a future phase.

**Rationale**: Eliminates persistence complexity during initial development, allowing
focus on core functionality and business logic.

### V. Unique Task Identification
Every task MUST be assigned a unique identifier. This ID MUST remain stable
throughout the task lifecycle and MUST NOT be reused after task deletion.

**Rationale**: Prevents ambiguity and enables reliable referencing across operations,
even after tasks are modified or removed.

### VI. Spec-First Bug Resolution
If a bug is discovered, the Specification in `/specs/` MUST be updated first,
then the code MUST be fixed to match the updated spec. Never fix code without
updating the corresponding spec.

**Rationale**: Maintains synchronization between requirements and implementation,
preventing divergence that leads to unclear system behavior.

---

## Phase III: AI-Agentic Standards

### VII. Architecture Isolation
Phase III MUST establish `/mcp-server` and `/ai-agent` as independent modules.
These modules MUST operate autonomously with well-defined interfaces. No coupling
or circular dependencies between Phase I/II codebase and Phase III components is
permitted.

**Rationale**: Ensures modularity, enables independent testing and deployment, and
prevents architectural debt from AI integration affecting existing functionality.

### VIII. Protocol Standardization
All AI-driven mutations MUST be forced through the Official Model Context Protocol
(MCP) SDK. No custom protocols, unofficial SDKs, or direct API bypasses are permitted.
Every data mutation initiated by AI MUST route through MCP tool definitions.

**Rationale**: Standardizes AI operations, enables observability and auditing of AI
actions, and maintains compliance with the broader MCP ecosystem.

### IX. Authentication Requirements
All MCP tool calls MUST require a valid `session_token`. No tool SHALL execute
without successful token validation against the backend authentication system.
Token-based identity verification MUST occur before any database operation or
state mutation.

**Rationale**: Prevents unauthorized data access, maintains security boundaries in
AI-human collaboration, and ensures all AI actions are attributable to authenticated users.

### X. Badge Integrity
Status badges (Done/Pending) MUST remain "Proper" and legible at all times.
CSS filters such as `blur`, `opacity`, or any visual degradations MUST NOT affect
status badges. Badges MUST maintain 100% contrast and sharp rendering under all
display conditions and interactions.

**Rationale**: Ensures accessibility and usability. Users must be able to instantly
and unambiguously identify task status without visual strain or ambiguity,
regardless of hover states, disabled conditions, or overlay effects.

---

## Technical Stack

- **Language**: Python 3.13+
- **Package Manager**: `uv`
- **Persistence**: In-memory storage only (Phase I)
- **Architecture**: Separation of concerns between CLI (UI) and Service (Logic)
- **Phase III Protocol**: Official MCP SDK for AI-driven operations

## Phase I Objectives

Implement the following core features:
- Add Task
- List Tasks
- Update Task
- Delete Task
- Toggle Completion

## Governance

All PRs and reviews MUST verify compliance with these principles. Complex deviations
MUST be documented and approved before implementation. Use the templates in
`.specify/templates/` for all new artifacts.

**Version**: 1.1.0 | **Ratified**: 2026-01-01 | **Last Amended**: 2026-01-06
